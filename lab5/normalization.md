# Лабораторна робота №5 (Нормалізація)

### 1. Аналіз поточної схеми та виявлення аномалій
В ході аналізу DDL схеми Лабораторної роботи №2 було розглянуто всі таблиці на предмет порушення нормалізації.

**Було виявлено наступні проблеми:**
1.  **Порушення 1NF (Атомарність):** У таблиці `administrators` поле `full_name` містить комбіновані дані, що ускладнює пошук та сортування.
2.  **Порушення 3NF (Транзитивна залежність):** Таблиця `shipments` дублює поля адреси (`country`, `city` тощо), які вже існують у таблиці `addresses`.
3.  **Цілісність даних:** Статуси замовлень та ролі зберігаються як текст, що не гарантує суворої типізації.

## 2. Функціональні залежності

### Таблиця: `users`
* **PK:** `id`
* **ФЗ:** `id` -> `{email, password_hash, created_at, deleted_at}`
* **Висновок:** Усі неключові атрибути залежать від повного первинного ключа. Відповідає 3NF.

### Таблиця: `products`
* **PK:** `id`
* **ФЗ:** `id` -> `{name, description, price, stock_quantity, sku, category_id, seller_id, is_active}`
* **Висновок:** Атрибути залежать від ID товару

### Таблиця: `orders`
* **PK:** `id`
* **ФЗ:** `id` -> `{buyer_id, total_amount, status, created_at}`
* **Примітка:** `total_amount` технічно залежить від суми записів у таблиці `order_items`, але зберігається тут для оптимізації (денормалізація заради продуктивності)

### Таблиця: `order_items`
* **PK:** `id`
* **ФЗ:** `id` -> `{order_id, product_id, quantity, price_at_purchase}`
* **Висновок:** Атрибути залежать від ID позиції замовлення

### Таблиця: `addresses`
* **PK:** `id`
* **ФЗ:** `id` -> `{user_id, country, city, street_line, zip_code}`
* **Примітка:**
* Потенційно існує транзитивна залежність `zip_code` -> `{city, country}`
* Але створення окремої таблиці довідника індексів потужно ускладнить систему без суттєвої вигоди для даного масштабу, тож було прийнято рішення залишити наявний формат таблиці

### 3. Процес нормалізації

1.  **Оцінка 1NF: Всі атрибути мають бути атомарними**:
    * **Проблема:** Таблиця `administrators` містила неатомарне поле `full_name`.
    * **Рішення:** Розбито на `first_name` та `last_name`.

2.  **Оцінка 2NF: Відсутність часткових залежностей (для складених ключів)**:
    * **Висновок:** Усі таблиці мають простий первинний ключ (`id`). Часткові залежності відсутні. Схема відповідає 2NF.

3.  **Оцінка 3NF: Відсутність транзитивних залежностей (неключовий атрибут не повинен залежати від іншого неключового атрибута)**:
    * **Проблема:** Таблиця `shipments` містила дублювання адресних даних.
    * **Рішення:** Замінено текстові поля адреси на зовнішній ключ `address_id`, що посилається на таблицю `addresses`.

4.  **Типізація (ENUM)**:
    * Замінено текстові обмеження `CHECK` на типи `ENUM` (`order_status`, `payment_status` тощо) для підвищення надійності даних.